<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dynamic Quote Generator</title>
</head>
<body>
  <h1>Dynamic Quote Generator</h1>
  
  <div id="quoteDisplay"></div>

  <input type="text" id="newQuote" placeholder="Enter a new quote">
  <button onclick="addQuote()">Add Quote</button>
  <button onclick="showRandomQuote()">Show Random Quote</button>
  <button onclick="exportToJsonFile()">Export Quotes (JSON)</button>
  
  <input type="file" id="importFile" accept=".json" onchange="importFromJsonFile(event)" />

  <script>
    // ======================
    // STEP 1: Load from Local Storage
    // ======================
    let quotes = JSON.parse(localStorage.getItem('quotes')) || [
      "The best way to get started is to quit talking and begin doing.",
      "Don't let yesterday take up too much of today.",
      "It's not whether you get knocked down, it's whether you get up."
    ];

    // Load last viewed quote from Session Storage
    let lastQuote = sessionStorage.getItem('lastQuote');
    if (lastQuote) {
      document.getElementById('quoteDisplay').textContent = lastQuote;
    }

    // ======================
    // Save quotes to Local Storage
    // ======================
    function saveQuotes() {
      localStorage.setItem('quotes', JSON.stringify(quotes));
    }

    // ======================
    // Show Random Quote
    // ======================
    function showRandomQuote() {
      const randomIndex = Math.floor(Math.random() * quotes.length);
      const randomQuote = quotes[randomIndex];
      document.getElementById('quoteDisplay').textContent = randomQuote;

      // Save last viewed quote to Session Storage
      sessionStorage.setItem('lastQuote', randomQuote);
    }

    // ======================
    // Add New Quote
    // ======================
    function addQuote() {
      const newQuote = document.getElementById('newQuote').value.trim();
      if (newQuote) {
        quotes.push(newQuote);
        saveQuotes();
        document.getElementById('newQuote').value = "";
        alert("Quote added successfully!");
      } else {
        alert("Please enter a quote.");
      }
    }

    // ======================
    // Export to JSON File
    // ======================
    function exportToJsonFile() {
      const blob = new Blob([JSON.stringify(quotes, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'quotes.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    // ======================
    // Import from JSON File
    // ======================
    function importFromJsonFile(event) {
      const fileReader = new FileReader();
      fileReader.onload = function(e) {
        try {
          const importedQuotes = JSON.parse(e.target.result);
          if (Array.isArray(importedQuotes)) {
            quotes.push(...importedQuotes);
            saveQuotes();
            alert('Quotes imported successfully!');
          } else {
            alert('Invalid JSON format.');
          }
        } catch (error) {
          alert('Error reading JSON file.');
        }
      };
      fileReader.readAsText(event.target.files[0]);
    }
  </script>
</body>
</html>
